# 効果的なデバッグ戦略

## 今回のRSS機能デバッグから学んだアプローチ

### 1. 問題の可視化

**「動かない」を「どこで止まっているか」に変換する**

最初の報告「RSSが動いていない」は曖昧すぎて対処不可能でした。詳細ログを追加することで：

- メッセージは受信されている
- しかし処理されていない
- Bot判定で除外されている

という具体的な問題箇所が特定できました。

### 2. 仮説駆動型デバッグ

**可能性のある原因を列挙し、体系的に検証**

考えられる原因：
- Discord接続の問題 → ログで否定
- チャンネル名の不一致 → ログで否定
- メッセージ処理の問題 → ログで確認
- Bot除外ルール → 原因特定！

### 3. 独立環境でのテスト

**本番環境から切り離して機能を検証**

独立したテストランナーを作成することで：
- Discord依存を排除
- 純粋な機能テストが可能
- 高速な試行錯誤

### 4. 段階的な修正

**一度にすべてを修正しない**

1. まずBot除外を緩和
2. 次に無限ループを発見
3. 自己メッセージ除外を追加
4. RSS専用処理を実装

各段階で動作確認を行うことで、新たな問題の早期発見が可能。

## デバッグツールの活用

### tmux の効果的な使用

- **Window 0**: 開発・コード編集
- **Window 1**: ログ監視専用
- **Window 2**: テスト実行

並行作業により、効率的なデバッグサイクルを実現。

### ログレベルの使い分け

```
ERROR: システムが対処できない問題
WARN:  注意が必要だが継続可能
INFO:  重要な状態遷移・イベント
DEBUG: 詳細な処理フロー
```

問題調査時はINFOレベルで主要な流れを追跡。

## 予防的プログラミング

### 早期リターンパターン

```
1. 自己チェック（最優先）
2. 基本的な検証
3. コンテキスト固有の検証
4. 実際の処理
```

最も重要な除外条件から順にチェックすることで、予期しない動作を防止。

### 明示的なログ出力

各判定ポイントで何が起きているかをログに残す：
- `[SKIP]` 処理をスキップした理由
- `[PROCESS]` 処理を継続する理由
- `[ERROR]` エラーの詳細

## まとめ

効果的なデバッグは：

1. **観察** - 何が起きているかを正確に把握
2. **仮説** - 原因を体系的に推測
3. **検証** - 独立した環境で仮説を検証
4. **修正** - 段階的に問題を解決
5. **確認** - 各段階で動作を確認

この循環を高速で回すことが、複雑な問題の解決につながります。